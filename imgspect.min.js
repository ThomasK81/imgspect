(function(b){function c(a,b){if(!(1<a.originalEvent.touches.length)){a.preventDefault();var c=a.originalEvent.changedTouches[0],e=document.createEvent("MouseEvents");e.initMouseEvent(b,!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null);a.target.dispatchEvent(e)}}b.support.touch="ontouchend"in document;if(b.support.touch){var a=b.ui.mouse.prototype,e=a._mouseInit,d;a._touchStart=function(a){!d&&this._mouseCapture(a.originalEvent.changedTouches[0])&&(d=!0,this._touchMoved=!1,
c(a,"mouseover"),c(a,"mousemove"),c(a,"mousedown"))};a._touchMove=function(a){d&&(this._touchMoved=!0,c(a,"mousemove"))};a._touchEnd=function(a){d&&(c(a,"mouseup"),c(a,"mouseout"),this._touchMoved||c(a,"click"),d=!1)};a._mouseInit=function(){this.element.bind("touchstart",b.proxy(this,"_touchStart")).bind("touchmove",b.proxy(this,"_touchMove")).bind("touchend",b.proxy(this,"_touchEnd"));e.call(this)}}})(jQuery);
jQuery.fn.cursorToEnd=function(){return this.each(function(){jQuery(this).focus();if(this.setSelectionRange){var b=2*jQuery(this).val().length;this.setSelectionRange(b,b)}else jQuery(this).val(jQuery(this).val());this.scrollTop=999999})};jQuery.fn.myHtml=function(){return jQuery(this).clone().wrap("<div>").parent().html()};jQuery.fn.transLength=function(){var b=jQuery(this).css("transition").match(/ [\d|\.]+s/g);return 1E3*Number(b[0].replace("s",""))};
String.prototype.smoosh=function(){return this.replace(/(\r\n+|\n+|\r+|\t+)/gm,"")};String.prototype.alphaSpaceOnly=function(){return this.replace(/[^\w\s]/gi,"")};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};String.prototype.repeat=function(b){return Array(b+1).join(this)};
String.prototype.occurs=function(b,c){if(void 0==b)return this.length;b+="";if(0>=b.length)return this.length;for(var a=0,e=0,d=c?1:b.length;;)if(e=this.indexOf(b,e),0<=e)a++,e+=d;else break;return a};String.prototype.params=function(){for(var b=this.split("?"),b=b[1].split("&"),c={},a=0,e=b.length;a<e;a++)if(void 0!=b[a]){var d=b[a].split("=");c[d[0]]=d[1]}return c};String.prototype.hasUpper=function(){return/[A-Z]/.test(this)};
String.prototype.report=function(){for(var b=this.toLowerCase().split(" "),c={},a=0,e=b.length;a<e;a++){var d=b[a];c[d]=d in c?c[d]+1:1}return c};String.prototype.lines=function(){return this.split("\n")};String.prototype.sentences=function(){for(var b=this.match(/[^\.!\?]+[\.!\?]+/g),c="aeiouy".split(""),a=[],e="",d=0;d<b.length;d++){for(var f=e+b[d],e="",g=!0,k=0;k<c.length;k++)if(-1!=f.indexOf(c[k])){g=!1;break}f.trim()[0].hasUpper()||(g=!0);g?0<a.length?a[a.length-1]+=f:e=f:a.push(f.smoosh().trim())}return a};
Date.CultureInfo={name:"en-US",englishName:"English (United States)",nativeName:"English (United States)",dayNames:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),abbreviatedDayNames:"Sun Mon Tue Wed Thu Fri Sat".split(" "),shortestDayNames:"Su Mo Tu We Th Fr Sa".split(" "),firstLetterDayNames:"SMTWTFS".split(""),monthNames:"January February March April May June July August September October November December".split(" "),abbreviatedMonthNames:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),
amDesignator:"AM",pmDesignator:"PM",firstDayOfWeek:0,twoDigitYearMax:2029,dateElementOrder:"mdy",formatPatterns:{shortDate:"M/d/yyyy",longDate:"dddd, MMMM dd, yyyy",shortTime:"h:mm tt",longTime:"h:mm:ss tt",fullDateTime:"dddd, MMMM dd, yyyy h:mm:ss tt",sortableDateTime:"yyyy-MM-ddTHH:mm:ss",universalSortableDateTime:"yyyy-MM-dd HH:mm:ssZ",rfc1123:"ddd, dd MMM yyyy HH:mm:ss GMT",monthDay:"MMMM dd",yearMonth:"MMMM, yyyy"},regexPatterns:{jan:/^jan(uary)?/i,feb:/^feb(ruary)?/i,mar:/^mar(ch)?/i,apr:/^apr(il)?/i,
may:/^may/i,jun:/^jun(e)?/i,jul:/^jul(y)?/i,aug:/^aug(ust)?/i,sep:/^sep(t(ember)?)?/i,oct:/^oct(ober)?/i,nov:/^nov(ember)?/i,dec:/^dec(ember)?/i,sun:/^su(n(day)?)?/i,mon:/^mo(n(day)?)?/i,tue:/^tu(e(s(day)?)?)?/i,wed:/^we(d(nesday)?)?/i,thu:/^th(u(r(s(day)?)?)?)?/i,fri:/^fr(i(day)?)?/i,sat:/^sa(t(urday)?)?/i,future:/^next/i,past:/^last|past|prev(ious)?/i,add:/^(\+|after|from)/i,subtract:/^(\-|before|ago)/i,yesterday:/^yesterday/i,today:/^t(oday)?/i,tomorrow:/^tomorrow/i,now:/^n(ow)?/i,millisecond:/^ms|milli(second)?s?/i,
second:/^sec(ond)?s?/i,minute:/^min(ute)?s?/i,hour:/^h(ou)?rs?/i,week:/^w(ee)?k/i,month:/^m(o(nth)?s?)?/i,day:/^d(ays?)?/i,year:/^y((ea)?rs?)?/i,shortMeridian:/^(a|p)/i,longMeridian:/^(a\.?m?\.?|p\.?m?\.?)/i,timezone:/^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\s*(\+|\-)\s*\d\d\d\d?)|gmt)/i,ordinalSuffix:/^\s*(st|nd|rd|th)/i,timeContext:/^\s*(\:|a|p)/i},abbreviatedTimeZoneStandard:{GMT:"-000",EST:"-0400",CST:"-0500",MST:"-0600",PST:"-0700"},abbreviatedTimeZoneDST:{GMT:"-000",EDT:"-0500",CDT:"-0600",
MDT:"-0700",PDT:"-0800"}};Date.getMonthNumberFromName=function(b){var c=Date.CultureInfo.monthNames,a=Date.CultureInfo.abbreviatedMonthNames;b=b.toLowerCase();for(var e=0;e<c.length;e++)if(c[e].toLowerCase()==b||a[e].toLowerCase()==b)return e;return-1};Date.getDayNumberFromName=function(b){var c=Date.CultureInfo.dayNames,a=Date.CultureInfo.abbreviatedDayNames;b=b.toLowerCase();for(var e=0;e<c.length;e++)if(c[e].toLowerCase()==b||a[e].toLowerCase()==b)return e;return-1};
Date.isLeapYear=function(b){return 0===b%4&&0!==b%100||0===b%400};Date.getDaysInMonth=function(b,c){return[31,Date.isLeapYear(b)?29:28,31,30,31,30,31,31,30,31,30,31][c]};Date.getTimezoneOffset=function(b,c){return c?Date.CultureInfo.abbreviatedTimeZoneDST[b.toUpperCase()]:Date.CultureInfo.abbreviatedTimeZoneStandard[b.toUpperCase()]};
Date.getTimezoneAbbreviation=function(b,c){var a=c?Date.CultureInfo.abbreviatedTimeZoneDST:Date.CultureInfo.abbreviatedTimeZoneStandard,e;for(e in a)if(a[e]===b)return e;return null};Date.prototype.clone=function(){return new Date(this.getTime())};Date.prototype.compareTo=function(b){if(isNaN(this))throw Error(this);if(b instanceof Date&&!isNaN(b))return this>b?1:this<b?-1:0;throw new TypeError(b);};Date.prototype.equals=function(b){return 0===this.compareTo(b)};
Date.prototype.between=function(b,c){var a=this.getTime();return a>=b.getTime()&&a<=c.getTime()};Date.prototype.addMilliseconds=function(b){this.setMilliseconds(this.getMilliseconds()+b);return this};Date.prototype.addSeconds=function(b){return this.addMilliseconds(1E3*b)};Date.prototype.addMinutes=function(b){return this.addMilliseconds(6E4*b)};Date.prototype.addHours=function(b){return this.addMilliseconds(36E5*b)};Date.prototype.addDays=function(b){return this.addMilliseconds(864E5*b)};
Date.prototype.addWeeks=function(b){return this.addMilliseconds(6048E5*b)};Date.prototype.addMonths=function(b){var c=this.getDate();this.setDate(1);this.setMonth(this.getMonth()+b);this.setDate(Math.min(c,this.getDaysInMonth()));return this};Date.prototype.addYears=function(b){return this.addMonths(12*b)};
Date.prototype.add=function(b){if("number"==typeof b)return this._orient=b,this;(b.millisecond||b.milliseconds)&&this.addMilliseconds(b.millisecond||b.milliseconds);(b.second||b.seconds)&&this.addSeconds(b.second||b.seconds);(b.minute||b.minutes)&&this.addMinutes(b.minute||b.minutes);(b.hour||b.hours)&&this.addHours(b.hour||b.hours);(b.month||b.months)&&this.addMonths(b.month||b.months);(b.year||b.years)&&this.addYears(b.year||b.years);(b.day||b.days)&&this.addDays(b.day||b.days);return this};
Date._validate=function(b,c,a,e){if("number"!=typeof b)throw new TypeError(b+" is not a Number.");if(b<c||b>a)throw new RangeError(b+" is not a valid value for "+e+".");return!0};Date.validateMillisecond=function(b){return Date._validate(b,0,999,"milliseconds")};Date.validateSecond=function(b){return Date._validate(b,0,59,"seconds")};Date.validateMinute=function(b){return Date._validate(b,0,59,"minutes")};Date.validateHour=function(b){return Date._validate(b,0,23,"hours")};
Date.validateDay=function(b,c,a){return Date._validate(b,1,Date.getDaysInMonth(c,a),"days")};Date.validateMonth=function(b){return Date._validate(b,0,11,"months")};Date.validateYear=function(b){return Date._validate(b,1,9999,"seconds")};
Date.prototype.set=function(b){b.millisecond||0===b.millisecond||(b.millisecond=-1);b.second||0===b.second||(b.second=-1);b.minute||0===b.minute||(b.minute=-1);b.hour||0===b.hour||(b.hour=-1);b.day||0===b.day||(b.day=-1);b.month||0===b.month||(b.month=-1);b.year||0===b.year||(b.year=-1);-1!=b.millisecond&&Date.validateMillisecond(b.millisecond)&&this.addMilliseconds(b.millisecond-this.getMilliseconds());-1!=b.second&&Date.validateSecond(b.second)&&this.addSeconds(b.second-this.getSeconds());-1!=b.minute&&
Date.validateMinute(b.minute)&&this.addMinutes(b.minute-this.getMinutes());-1!=b.hour&&Date.validateHour(b.hour)&&this.addHours(b.hour-this.getHours());-1!==b.month&&Date.validateMonth(b.month)&&this.addMonths(b.month-this.getMonth());-1!=b.year&&Date.validateYear(b.year)&&this.addYears(b.year-this.getFullYear());-1!=b.day&&Date.validateDay(b.day,this.getFullYear(),this.getMonth())&&this.addDays(b.day-this.getDate());b.timezone&&this.setTimezone(b.timezone);b.timezoneOffset&&this.setTimezoneOffset(b.timezoneOffset);
return this};Date.prototype.clearTime=function(){this.setHours(0);this.setMinutes(0);this.setSeconds(0);this.setMilliseconds(0);return this};Date.prototype.isLeapYear=function(){var b=this.getFullYear();return 0===b%4&&0!==b%100||0===b%400};Date.prototype.isWeekday=function(){return!(this.is().sat()||this.is().sun())};Date.prototype.getDaysInMonth=function(){return Date.getDaysInMonth(this.getFullYear(),this.getMonth())};Date.prototype.moveToFirstDayOfMonth=function(){return this.set({day:1})};
Date.prototype.moveToLastDayOfMonth=function(){return this.set({day:this.getDaysInMonth()})};Date.prototype.moveToDayOfWeek=function(b,c){var a=(b-this.getDay()+7*(c||1))%7;return this.addDays(0===a?a+7*(c||1):a)};Date.prototype.moveToMonth=function(b,c){var a=(b-this.getMonth()+12*(c||1))%12;return this.addMonths(0===a?a+12*(c||1):a)};Date.prototype.getDayOfYear=function(){return Math.floor((this-new Date(this.getFullYear(),0,1))/864E5)};
Date.prototype.getWeekOfYear=function(b){var c=this.getFullYear(),a=this.getMonth(),e=this.getDate();b=b||Date.CultureInfo.firstDayOfWeek;var d=8-(new Date(c,0,1)).getDay();8==d&&(d=1);a=(Date.UTC(c,a,e,0,0,0)-Date.UTC(c,0,1,0,0,0))/864E5+1;a=Math.floor((a-d+7)/7);a===b&&(c--,c=8-(new Date(c,0,1)).getDay(),a=2==c||8==c?53:52);return a};Date.prototype.isDST=function(){console.log("isDST");return"D"==this.toString().match(/(E|C|M|P)(S|D)T/)[2]};
Date.prototype.getTimezone=function(){return Date.getTimezoneAbbreviation(this.getUTCOffset,this.isDST())};Date.prototype.setTimezoneOffset=function(b){var c=this.getTimezoneOffset();this.addMinutes(-6*Number(b)/10-c);return this};Date.prototype.setTimezone=function(b){return this.setTimezoneOffset(Date.getTimezoneOffset(b))};Date.prototype.getUTCOffset=function(){var b=-10*this.getTimezoneOffset()/6;if(0>b)return b=(b-1E4).toString(),b[0]+b.substr(2);b=(b+1E4).toString();return"+"+b.substr(1)};
Date.prototype.getDayName=function(b){return b?Date.CultureInfo.abbreviatedDayNames[this.getDay()]:Date.CultureInfo.dayNames[this.getDay()]};Date.prototype.getMonthName=function(b){return b?Date.CultureInfo.abbreviatedMonthNames[this.getMonth()]:Date.CultureInfo.monthNames[this.getMonth()]};Date.prototype._toString=Date.prototype.toString;
Date.prototype.toString=function(b){var c=this,a=function(a){return 1==a.toString().length?"0"+a:a};return b?b.replace(/dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?/g,function(b){switch(b){case "hh":return a(13>c.getHours()?c.getHours():c.getHours()-12);case "h":return 13>c.getHours()?c.getHours():c.getHours()-12;case "HH":return a(c.getHours());case "H":return c.getHours();case "mm":return a(c.getMinutes());case "m":return c.getMinutes();case "ss":return a(c.getSeconds());case "s":return c.getSeconds();
case "yyyy":return c.getFullYear();case "yy":return c.getFullYear().toString().substring(2,4);case "dddd":return c.getDayName();case "ddd":return c.getDayName(!0);case "dd":return a(c.getDate());case "d":return c.getDate().toString();case "MMMM":return c.getMonthName();case "MMM":return c.getMonthName(!0);case "MM":return a(c.getMonth()+1);case "M":return c.getMonth()+1;case "t":return 12>c.getHours()?Date.CultureInfo.amDesignator.substring(0,1):Date.CultureInfo.pmDesignator.substring(0,1);case "tt":return 12>
c.getHours()?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator;case "zzz":case "zz":case "z":return""}}):this._toString()};Date.now=function(){return new Date};Date.today=function(){return Date.now().clearTime()};Date.prototype._orient=1;Date.prototype.next=function(){this._orient=1;return this};Date.prototype.last=Date.prototype.prev=Date.prototype.previous=function(){this._orient=-1;return this};Date.prototype._is=!1;Date.prototype.is=function(){this._is=!0;return this};
Number.prototype._dateElement="day";Number.prototype.fromNow=function(){var b={};b[this._dateElement]=this;return Date.now().add(b)};Number.prototype.ago=function(){var b={};b[this._dateElement]=-1*this;return Date.now().add(b)};
(function(){for(var b=Date.prototype,c=Number.prototype,a="sunday monday tuesday wednesday thursday friday saturday".split(/\s/),e="january february march april may june july august september october november december".split(/\s/),d="Millisecond Second Minute Hour Day Week Month Year".split(/\s/),f=function(a){return function(){return this._is?(this._is=!1,this.getDay()==a):this.moveToDayOfWeek(a,this._orient)}},g=0;g<a.length;g++)b[a[g]]=b[a[g].substring(0,3)]=f(g);a=function(a){return function(){return this._is?
(this._is=!1,this.getMonth()===a):this.moveToMonth(a,this._orient)}};for(f=0;f<e.length;f++)b[e[f]]=b[e[f].substring(0,3)]=a(f);a=function(a){return function(){"s"!=a.substring(a.length-1)&&(a+="s");return this["add"+a](this._orient)}};f=function(a){return function(){this._dateElement=a;return this}};for(g=0;g<d.length;g++)e=d[g].toLowerCase(),b[e]=b[e+"s"]=a(d[g]),c[e]=c[e+"s"]=f(e)})();Date.prototype.toJSONString=function(){return this.toString("yyyy-MM-ddThh:mm:ssZ")};
Date.prototype.toShortDateString=function(){return this.toString(Date.CultureInfo.formatPatterns.shortDatePattern)};Date.prototype.toLongDateString=function(){return this.toString(Date.CultureInfo.formatPatterns.longDatePattern)};Date.prototype.toShortTimeString=function(){return this.toString(Date.CultureInfo.formatPatterns.shortTimePattern)};Date.prototype.toLongTimeString=function(){return this.toString(Date.CultureInfo.formatPatterns.longTimePattern)};
Date.prototype.getOrdinal=function(){switch(this.getDate()){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}};
(function(){Date.Parsing={Exception:function(a){this.message="Parse error at '"+a.substring(0,10)+" ...'"}};for(var b=Date.Parsing,c=b.Operators={rtoken:function(a){return function(c){var e=c.match(a);if(e)return[e[0],c.substring(e[0].length)];throw new b.Exception(c);}},token:function(a){return function(a){return c.rtoken(RegExp("^s*"+a+"s*"))(a)}},stoken:function(a){return c.rtoken(RegExp("^"+a))},until:function(a){return function(b){for(var c=[],e=null;b.length;){try{e=a.call(this,b)}catch(d){c.push(e[0]);
b=e[1];continue}break}return[c,b]}},many:function(a){return function(b){for(var c=[],e=null;b.length;){try{e=a.call(this,b)}catch(d){break}c.push(e[0]);b=e[1]}return[c,b]}},optional:function(a){return function(b){var c=null;try{c=a.call(this,b)}catch(e){return[null,b]}return[c[0],c[1]]}},not:function(a){return function(c){try{a.call(this,c)}catch(e){return[null,c]}throw new b.Exception(c);}},ignore:function(a){return a?function(b){var c=null,c=a.call(this,b);return[null,c[1]]}:null},product:function(){for(var a=
arguments[0],b=Array.prototype.slice.call(arguments,1),e=[],d=0;d<a.length;d++)e.push(c.each(a[d],b));return e},cache:function(a){var c={},e=null;return function(d){try{e=c[d]=c[d]||a.call(this,d)}catch(h){e=c[d]=h}if(e instanceof b.Exception)throw e;return e}},any:function(){var a=arguments;return function(c){for(var e=null,d=0;d<a.length;d++)if(null!=a[d]){try{e=a[d].call(this,c)}catch(h){e=null}if(e)return e}throw new b.Exception(c);}},each:function(){var a=arguments;return function(c){for(var e=
[],d=null,h=0;h<a.length;h++)if(null!=a[h]){try{d=a[h].call(this,c)}catch(m){throw new b.Exception(c);}e.push(d[0]);c=d[1]}return[e,c]}},all:function(){var a=a;return a.each(a.optional(arguments))},sequence:function(a,e,d){e=e||c.rtoken(/^\s*/);d=d||null;return 1==a.length?a[0]:function(c){for(var h=null,m=null,n=[],p=0;p<a.length;p++){try{h=a[p].call(this,c)}catch(q){break}n.push(h[0]);try{m=e.call(this,h[1])}catch(s){m=null;break}c=m[1]}if(!h)throw new b.Exception(c);if(m)throw new b.Exception(m[1]);
if(d)try{h=d.call(this,h[1])}catch(t){throw new b.Exception(h[1]);}return[n,h?h[1]:c]}},between:function(a,b,e){e=e||a;var d=c.each(c.ignore(a),b,c.ignore(e));return function(a){a=d.call(this,a);return[[a[0][0],r[0][2]],a[1]]}},list:function(a,b,e){b=b||c.rtoken(/^\s*/);e=e||null;return a instanceof Array?c.each(c.product(a.slice(0,-1),c.ignore(b)),a.slice(-1),c.ignore(e)):c.each(c.many(c.each(a,c.ignore(b))),px,c.ignore(e))},set:function(a,e,d){e=e||c.rtoken(/^\s*/);d=d||null;return function(l){for(var h=
null,m=h=null,n=null,p=[[],l],q=!1,s=0;s<a.length;s++){h=m=null;q=1==a.length;try{h=a[s].call(this,l)}catch(t){continue}n=[[h[0]],h[1]];if(0<h[1].length&&!q)try{m=e.call(this,h[1])}catch(u){q=!0}else q=!0;q||0!==m[1].length||(q=!0);if(!q){h=[];for(q=0;q<a.length;q++)s!=q&&h.push(a[q]);h=c.set(h,e).call(this,m[1]);0<h[0].length&&(n[0]=n[0].concat(h[0]),n[1]=h[1])}n[1].length<p[1].length&&(p=n);if(0===p[1].length)break}if(0===p[0].length)return p;if(d){try{m=d.call(this,p[1])}catch(v){throw new b.Exception(p[1]);
}p[1]=m[1]}return p}},forward:function(a,b){return function(c){return a[b].call(this,c)}},replace:function(a,b){return function(c){c=a.call(this,c);return[b,c[1]]}},process:function(a,b){return function(c){c=a.call(this,c);return[b.call(this,c[0]),c[1]]}},min:function(a,c){return function(e){var d=c.call(this,e);if(d[0].length<a)throw new b.Exception(e);return d}}},a=function(a){return function(){var b=null,c=[];1<arguments.length?b=Array.prototype.slice.call(arguments):arguments[0]instanceof Array&&
(b=arguments[0]);if(b)for(var e=b.shift();0<e.length;)return b.unshift(e[0]),c.push(a.apply(null,b)),b.shift(),c;else return a.apply(null,arguments)}},e="optional not ignore cache".split(/\s/),d=0;d<e.length;d++)c[e[d]]=a(c[e[d]]);a=function(a){return function(){return arguments[0]instanceof Array?a.apply(null,arguments[0]):a.apply(null,arguments)}};e="each any all".split(/\s/);for(d=0;d<e.length;d++)c[e[d]]=a(c[e[d]])})();
(function(){var b=function(a){for(var c=[],e=0;e<a.length;e++)a[e]instanceof Array?c=c.concat(b(a[e])):a[e]&&c.push(a[e]);return c};Date.Grammar={};Date.Translator={hour:function(a){return function(){this.hour=Number(a)}},minute:function(a){return function(){this.minute=Number(a)}},second:function(a){return function(){this.second=Number(a)}},meridian:function(a){return function(){this.meridian=a.slice(0,1).toLowerCase()}},timezone:function(a){return function(){var b=a.replace(/[^\d\+\-]/g,"");b.length?
this.timezoneOffset=Number(b):this.timezone=a.toLowerCase()}},day:function(a){var b=a[0];return function(){this.day=Number(b.match(/\d+/)[0])}},month:function(a){return function(){this.month=3==a.length?Date.getMonthNumberFromName(a):Number(a)-1}},year:function(a){return function(){var b=Number(a);this.year=2<a.length?b:b+(b+2E3<Date.CultureInfo.twoDigitYearMax?2E3:1900)}},rday:function(a){return function(){switch(a){case "yesterday":this.days=-1;break;case "tomorrow":this.days=1;break;case "today":this.days=
0;break;case "now":this.days=0,this.now=!0}}},finishExact:function(a){a=a instanceof Array?a:[a];var b=new Date;this.year=b.getFullYear();this.month=b.getMonth();this.day=1;for(b=this.second=this.minute=this.hour=0;b<a.length;b++)a[b]&&a[b].call(this);this.hour="p"==this.meridian&&13>this.hour?this.hour+12:this.hour;if(this.day>Date.getDaysInMonth(this.year,this.month))throw new RangeError(this.day+" is not a valid value for days.");a=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second);
this.timezone?a.set({timezone:this.timezone}):this.timezoneOffset&&a.set({timezoneOffset:this.timezoneOffset});return a},finish:function(a){a=a instanceof Array?b(a):[a];if(0===a.length)return null;for(var c=0;c<a.length;c++)"function"==typeof a[c]&&a[c].call(this);if(this.now)return new Date;a=Date.today();if(null!=this.days||this.orient||this.operator){var e,d;d="past"==this.orient||"subtract"==this.operator?-1:1;this.weekday&&(this.unit="day",c=Date.getDayNumberFromName(this.weekday)-a.getDay(),
e=7,this.days=c?(c+d*e)%e:d*e);this.month&&(this.unit="month",c=this.month-a.getMonth(),e=12,this.months=c?(c+d*e)%e:d*e,this.month=null);this.unit||(this.unit="day");if(null==this[this.unit+"s"]||null!=this.operator)this.value||(this.value=1),"week"==this.unit&&(this.unit="day",this.value*=7),this[this.unit+"s"]=this.value*d;return a.add(this)}this.meridian&&this.hour&&(this.hour=13>this.hour&&"p"==this.meridian?this.hour+12:this.hour);this.weekday&&!this.day&&(this.day=a.addDays(Date.getDayNumberFromName(this.weekday)-
a.getDay()).getDate());this.month&&!this.day&&(this.day=1);return a.set(this)}};var c=Date.Parsing.Operators,a=Date.Grammar,e=Date.Translator,d;a.datePartDelimiter=c.rtoken(/^([\s\-\.\,\/\x27]+)/);a.timePartDelimiter=c.stoken(":");a.whiteSpace=c.rtoken(/^\s*/);a.generalDelimiter=c.rtoken(/^(([\s\,]|at|on)+)/);var f={};a.ctoken=function(a){var b=f[a];if(!b){for(var b=Date.CultureInfo.regexPatterns,e=a.split(/\s+/),d=[],g=0;g<e.length;g++)d.push(c.replace(c.rtoken(b[e[g]]),e[g]));b=f[a]=c.any.apply(null,
d)}return b};a.ctoken2=function(a){return c.rtoken(Date.CultureInfo.regexPatterns[a])};a.h=c.cache(c.process(c.rtoken(/^(0[0-9]|1[0-2]|[1-9])/),e.hour));a.hh=c.cache(c.process(c.rtoken(/^(0[0-9]|1[0-2])/),e.hour));a.H=c.cache(c.process(c.rtoken(/^([0-1][0-9]|2[0-3]|[0-9])/),e.hour));a.HH=c.cache(c.process(c.rtoken(/^([0-1][0-9]|2[0-3])/),e.hour));a.m=c.cache(c.process(c.rtoken(/^([0-5][0-9]|[0-9])/),e.minute));a.mm=c.cache(c.process(c.rtoken(/^[0-5][0-9]/),e.minute));a.s=c.cache(c.process(c.rtoken(/^([0-5][0-9]|[0-9])/),
e.second));a.ss=c.cache(c.process(c.rtoken(/^[0-5][0-9]/),e.second));a.hms=c.cache(c.sequence([a.H,a.mm,a.ss],a.timePartDelimiter));a.t=c.cache(c.process(a.ctoken2("shortMeridian"),e.meridian));a.tt=c.cache(c.process(a.ctoken2("longMeridian"),e.meridian));a.z=c.cache(c.process(c.rtoken(/^(\+|\-)?\s*\d\d\d\d?/),e.timezone));a.zz=c.cache(c.process(c.rtoken(/^(\+|\-)\s*\d\d\d\d/),e.timezone));a.zzz=c.cache(c.process(a.ctoken2("timezone"),e.timezone));a.timeSuffix=c.each(c.ignore(a.whiteSpace),c.set([a.tt,
a.zzz]));a.time=c.each(c.optional(c.ignore(c.stoken("T"))),a.hms,a.timeSuffix);a.d=c.cache(c.process(c.each(c.rtoken(/^([0-2]\d|3[0-1]|\d)/),c.optional(a.ctoken2("ordinalSuffix"))),e.day));a.dd=c.cache(c.process(c.each(c.rtoken(/^([0-2]\d|3[0-1])/),c.optional(a.ctoken2("ordinalSuffix"))),e.day));a.ddd=a.dddd=c.cache(c.process(a.ctoken("sun mon tue wed thu fri sat"),function(a){return function(){this.weekday=a}}));a.M=c.cache(c.process(c.rtoken(/^(1[0-2]|0\d|\d)/),e.month));a.MM=c.cache(c.process(c.rtoken(/^(1[0-2]|0\d)/),
e.month));a.MMM=a.MMMM=c.cache(c.process(a.ctoken("jan feb mar apr may jun jul aug sep oct nov dec"),e.month));a.y=c.cache(c.process(c.rtoken(/^(\d\d?)/),e.year));a.yy=c.cache(c.process(c.rtoken(/^(\d\d)/),e.year));a.yyy=c.cache(c.process(c.rtoken(/^(\d\d?\d?\d?)/),e.year));a.yyyy=c.cache(c.process(c.rtoken(/^(\d\d\d\d)/),e.year));d=function(){return c.each(c.any.apply(null,arguments),c.not(a.ctoken2("timeContext")))};a.day=d(a.d,a.dd);a.month=d(a.M,a.MMM);a.year=d(a.yyyy,a.yy);a.orientation=c.process(a.ctoken("past future"),
function(a){return function(){this.orient=a}});a.operator=c.process(a.ctoken("add subtract"),function(a){return function(){this.operator=a}});a.rday=c.process(a.ctoken("yesterday tomorrow today now"),e.rday);a.unit=c.process(a.ctoken("minute hour day week month year"),function(a){return function(){this.unit=a}});a.value=c.process(c.rtoken(/^\d\d?(st|nd|rd|th)?/),function(a){return function(){this.value=a.replace(/\D/g,"")}});a.expression=c.set([a.rday,a.operator,a.value,a.unit,a.orientation,a.ddd,
a.MMM]);d=function(){return c.set(arguments,a.datePartDelimiter)};a.mdy=d(a.ddd,a.month,a.day,a.year);a.ymd=d(a.ddd,a.year,a.month,a.day);a.dmy=d(a.ddd,a.day,a.month,a.year);a.date=function(b){return(a[Date.CultureInfo.dateElementOrder]||a.mdy).call(this,b)};a.format=c.process(c.many(c.any(c.process(c.rtoken(/^(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?)/),function(b){if(a[b])return a[b];throw Date.Parsing.Exception(b);}),c.process(c.rtoken(/^[^dMyhHmstz]+/),function(a){return c.ignore(c.stoken(a))}))),
function(a){return c.process(c.each.apply(null,a),e.finishExact)});var g={},k=function(b){return g[b]=g[b]||a.format(b)[0]};a.formats=function(a){if(a instanceof Array){for(var b=[],e=0;e<a.length;e++)b.push(k(a[e]));return c.any.apply(null,b)}return k(a)};a._formats=a.formats(["yyyy-MM-ddTHH:mm:ss","ddd, MMM dd, yyyy H:mm:ss tt","ddd MMM d yyyy HH:mm:ss zzz","d"]);a._start=c.process(c.set([a.date,a.time,a.expression],a.generalDelimiter,a.whiteSpace),e.finish);a.start=function(b){try{var c=a._formats.call({},
b);if(0===c[1].length)return c}catch(e){}return a._start.call({},b)}})();Date._parse=Date.parse;Date.parse=function(b){var c=null;if(!b)return null;try{c=Date.Grammar.start.call({},b)}catch(a){return null}return 0===c[1].length?c[0]:null};Date.getParseFunction=function(b){var c=Date.Grammar.formats(b);return function(a){var b=null;try{b=c.call({},a)}catch(d){return null}return 0===b[1].length?b[0]:null}};Date.parseExact=function(b,c){return Date.getParseFunction(c)(b)};function TimeStamp(){}
TimeStamp.prototype.withUtc=function(b){var c=new Date,a=c.getFullYear(),e=("0"+(c.getMonth()+1)).slice(-2),d=("0"+c.getDate()).slice(-2),f=c.getHours(),g=("0"+c.getMinutes()).slice(-2),k=("0"+c.getSeconds()).slice(-2),l=("0"+c.getMilliseconds()).slice(-3),c=c.getTimezoneOffset(),h="",h=b?a+"-"+e+"-"+d+"T"+f+":"+g+":"+k+":"+l+"UTC":a+"-"+e+"-"+d+"T"+f+":"+g+":"+k+"UTC";return 0<c?h+"+"+c:h+"-"+c};TimeStamp.prototype.unix=function(){return(new Date).getTime()};
TimeStamp.prototype.toUnix=function(b){b=b.replace(/UTC.*/,"");var c=0;b.match(/:\d{3}/)&&(c=b.slice(-4),b=b.replace(/:\d+$/,""),c=parseInt(c.replace(":","")));return Date.parse(b).getTime()+c};ObjectExt=function(){};ObjectExt.prototype.mergeAdd=function(b,c){for(var a in b)c[a]=a in c?c[a]+b[a]:1};ObjectExt.prototype.totalChars=function(b,c,a){c=void 0==c?0:c;a=void 0==a?0:a;for(var e=0,d=b.length;e<d;e++){if("object"==typeof b[e])return a++,this.totalChars(b[e],c,a);c+=b[e].toString().length}return c};
ObjectExt.prototype.totalKeys=function(b){var c=0,a;for(a in b)b.hasOwnProperty(a)&&c++;return c};ObjectExt.prototype.wrap=function(b,c,a){a=void 0==a?c:a;for(var e=[],d=0,f=b.length;d<f;d++)e[d]=c.toString()+b[d]+a.toString();return e};
ObjectExt.prototype.clone=function(b){if(null==b||"_object"!=typeof b)return b;if(b instanceof Date){var c=new Date;c.setTime(b.getTime());return c}if(b instanceof Array){for(var c=[],a=0,e=b.length;a<e;a++)c[a]=this.clone(b[a]);return c}if(b instanceof Object){c={};for(a in b)b.hasOwnProperty(a)&&(c[a]=this.clone(b[a]));return c}throw Error("Unable to copy obj! Its type isn't supported.");};
ObjectExt.prototype.byString=function(b,c){if(void 0==c)return b;c=c.replace(/\[['|"]*(\w+)['|"]*\]/g,".$1");c=c.replace(/^\./,"");for(var a=c.split(".");a.length;){var e=a.shift();if(e in b)b=b[e];else return}return b};function Culuh(b){this.v=this.s=this.h=this.b=this.g=this.r=0;void 0!=b&&(this.original=b,this.reset(),this.hsvUpdate())}
Culuh.prototype.reset=function(){var b=this.original,b=b.toUpperCase();-1<b.indexOf("RGB")?(b=b.match(/\d+\.?\d*/g),this.r=parseInt(b[0]),this.g=parseInt(b[1]),this.b=parseInt(b[2])):(b=b.match(/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i),this.r=this.hexToInt(b[1]),this.g=this.hexToInt(b[2]),this.b=this.hexToInt(b[3]))};
Culuh.prototype.hsvUpdate=function(){var b,c;b=this.r/255;var a=this.g/255,e=this.b/255;c=Math.min(b,a,e);var d=Math.max(b,a,e),f=d-c;c=0==d?0:f/d;0==c?b=0:(b=b==d?(a-e)/f:a==d?2+(e-b)/f:4+(b-a)/f,isNaN(b)&&(b=0),b/=6,0>b&&b++);this.h=255*b;this.s=255*c;this.v=255*d};
Culuh.prototype.rgbUpdate=function(){var b,c,a,e=this.h/255,d=this.s/255,f=this.v/255;if(0==d)b=c=a=f;else{var e=6*e,g=e%1,k=f*(1-d),l=f*(1-d*g),d=f*(1-d*(1-g));switch(Math.floor(e)){case 0:b=f;c=d;a=k;break;case 1:b=l;c=f;a=k;break;case 2:b=k;c=f;a=d;break;case 3:b=k;c=l;a=f;break;case 4:b=d;c=k;a=f;break;case 5:b=f,c=k,a=l}}this.r=parseInt(255*b);this.g=parseInt(255*c);this.b=parseInt(255*a)};Culuh.prototype.hex=function(b){return(void 0==b?"":b)+this.rHex()+this.gHex()+this.bHex()};
Culuh.prototype.rgb=function(){return"rgb("+this.r+","+this.g+","+this.b+")"};Culuh.prototype.rHex=function(){return this.intToHex(this.r)};Culuh.prototype.gHex=function(){return this.intToHex(this.g)};Culuh.prototype.bHex=function(){return this.intToHex(this.b)};Culuh.prototype.rInt=function(){return this.r};Culuh.prototype.gInt=function(){return this.g};Culuh.prototype.bInt=function(){return this.b};Culuh.prototype.hexToInt=function(b){return parseInt(b,16)};
Culuh.prototype.intToHex=function(b){b=b.toString(16);2>b.length&&(b="0"+b);return b.toUpperCase()};Culuh.prototype.sat=function(b,c){var a=this.s,a=a*b;if(!0!=c)this.s=a,this.rgbUpdate();else return a=new Culuh(this.rgb()),a.sat(b),a};Culuh.prototype.invert=function(b){if(!0!=b)this.r=255-this.r,this.g=255-this.g,this.b=255-this.b,this.hsvUpdate();else return b=new Culuh(this.rgb()),b.invert(),b};
(function(b){function c(a,b,c){this.elem=a;this.id=c;this.init(a,b)}c.prototype.init=function(a,c){this.options=b.extend({closed:"&#9660;",open:"&#9650;",button_classes:null,up:!1,cover:!1},c);this.events={open:"MENUMUCIL-OPEN",closed:"MENUMUCIL-CLOSED"};this.clicker=this.pane=this.menu=null;this.build()};c.prototype.build=function(){var a=this;a.menu=b(a.elem);a.menu.addClass("menumucil");(a.options.cover||a.options.up)&&a.menu.css({position:"absolute","z-index":5E3});a.menu.wrapInner('<div class="inner" />');
a.menu.wrapInner('<div class="pane" />');a.pane=b(".pane",a.elem);a.pane.addClass("closed");a.clicker=b(document.createElement("a"));a.clicker.attr("href","#");a.clicker.addClass("clicker");null!=a.options.button_classes&&a.clicker.addClass(a.options.button_classes);a.menu.append(a.clicker);a.icon=b(document.createElement("span"));a.icon.addClass("icon");a.clicker.append(a.icon);a.icon.html(a.options.closed);a.extra=b(document.createElement("span"));a.extra.addClass("extra");a.clicker.append(a.extra);
a.pane.on("transitionEnd webkitTransitionEnd transitionend oTransitionEnd msTransitionEnd",function(b){a.pane.hasClass("open")&&a.pane.css("max-height",9999)});if(a.options.cover||a.options.up){var c=a.clicker.height();a.menu.after('<div style="height:'+c+'px;clear:both"></div>')}a.closeNow();b(a.clicker).click(function(b){a.isOpen()?a.close():a.pane.hasClass("closed")&&a.open();b.preventDefault()})};c.prototype.isOpen=function(){return this.pane.hasClass("open")?!0:!1};c.prototype.isClosed=function(){return this.pane.hasClass("closed")?
!0:!1};c.prototype.open=function(){this.pane.contentHeight=this.pane.outerHeight();this.pane.contentHeight+=b(".inner",this.elem).outerHeight();this.pane.css({"max-height":this.pane.contentHeight});this.options.up&&this.menu.css({top:this.menu.position().top-this.pane.contentHeight});this.pane.removeClass("closed");this.pane.addClass("open");this.icon.html(this.options.open);this.pane.trigger(this.events.open,[this.id])};c.prototype.close=function(){var a=this;a.pane.contentHeight=a.pane.outerHeight();
a.pane.removeClass("transitions").css("max-height",a.pane.contentHeight);setTimeout(function(){a.closeNow();a.pane.removeClass("open");a.pane.addClass("closed");a.icon.html(a.options.closed);a.menu.trigger(a.events.closed,[a.id])},10)};c.prototype.closeNow=function(){this.pane.addClass("transitions").css({"max-height":0})};jQuery(document).ready(function(a){jQuery.fn.menumucil=function(a){var b=jQuery(this).selector;return this.each(function(){jQuery.data(this,b,new c(this,a,b))})}})})(jQuery);
function Sorted(){}
Sorted.prototype.areaSort=function(b,c,a,e,d,f){var g=new ObjectExt;d=void 0==d?[]:d;f=void 0==f?0:f;c=void 0==c?"x":c;a=void 0==a?"y1":a;e=void 0==e?"y2":e;d.length-1<f&&(d[f]=[]);if("object"!==typeof b[0])throw"Sorted.areaSort() -- First parameter must be an array of objects";for(var k=0,l=parseInt(g.byString(b[k],a)),h=1,m=b.length;h<m;h++){var n=parseInt(g.byString(b[h],a));n<l&&(l=n,k=h)}h=b.splice(k,1);h=h[0];d[f].push(h);k=parseInt(g.byString(h,a));l=parseInt(g.byString(h,e));for(h=b.length;h--;)n=
parseInt(g.byString(b[h],a)),m=parseInt(g.byString(b[h],e))-n,n+=m/2,n>=k&&n<=l&&(n=b.splice(h,1),n=n[0],d[f].push(n));if(0==b.length){h=0;for(m=d.length;h<m;h++)d[h]=this.numSort(d[h],c);return d}return this.areaSort(b,c,a,e,d,f+1)};Sorted.prototype.numSort=function(b,c){var a=new ObjectExt;return b.sort(function(b,d){var f=Number(a.byString(b,c)),g=Number(a.byString(d,c));return f-g})};
(function(b){function c(a,b,c){this.elem=a;this.id=c;this.init(a,b)}c.prototype.init=function(a,b){this.elem=a;this.options=jQuery.extend({button:"close"},b);this.obj={id:null,HIDDEN:"-9999px"};this.create()};c.prototype.position=function(){var a=(b(window).width()-b(this.elem).width())/2,c=(b(window).height()-b(this.elem).height())/2;b(this.elem).css({display:"block",position:"absolute","z-index":"9999",top:c+"px",left:a+"px"})};c.prototype.popup=function(){var a=this;a.position();b(document).trigger("PLOPUP-POPPED",
a.obj.id);b(window).resize(function(){"block"==b(a.elem).css("display")&&b(a.elem).css("top")!=a.obj.HIDDEN&&a.position()})};c.prototype.hide=function(){b(this.elem).css({top:this.obj.HIDDEN})};c.prototype.create=function(){var a=this;a.obj.id=b(a.elem).attr("id");b(a.elem).css({display:"none"});var c=b(document.createElement("div"));c.css({clear:"both"});b(a.elem).prepend(c);c=b(document.createElement("a"));c.html(a.options.button);c.attr("href","#"+a.obj.id+"-close");c.addClass("plopup");c.addClass("close");
b(a.elem).prepend(c);c.css({clear:"both"});c.click(function(b){a.hide();b.preventDefault()});b(document).bind("PLOPUP-POPPED",function(c,e){e!=a.obj.id&&"block"==b(a.elem).css("display")&&b(a.elem).css("top")!=a.obj.HIDDEN&&b(a.elem).css({top:a.obj.HIDDEN})});b("a",document).click(function(c){var e=b(this).attr("href");void 0!=e&&(e=e.replace("#",""),e==a.obj.id&&(a.popup(),c.preventDefault()))})};jQuery(document).ready(function(a){jQuery.fn.plopup=function(a){var b=jQuery(this).selector;return this.each(function(){jQuery.data(this,
b,new c(this,a,b))})}})})(jQuery);var PerseidsBridge=PerseidsBridge||{REVISION:"1"};
PerseidsBridge.imgspect=function(){function b(){var a=this;a.imgspect=null;a.output=null;a.warning=null;a.img=null;a.w_tags={};a.load=function(b){null!=a.imgspect&&!1==(void 0==b?!1:b)?(a.buildWarning(),a.warning.popup()):(a.buildWait(),a.warning.popup(),$(".imgUrn").removeClass("selected"),$('.imgUrn[rel="'+a.img.src+'"]').addClass("selected"),$("#imgspect").empty(),$("#imgspect").append(a.img),a.imgspect=$("#imgspect img").imgspect().data("#imgspect img"),a.urn=a.getUrn(),$("#ict_tool").addClass("imgspectLoaded"),
$(a.imgspect.elem).on("IMGSPECT-UPDATE",function(){var b=a.buildTags();$(".imgspect .output").val(b.join("\n\n"))}))};a.buildTags=function(){for(var b=[],c=0,f=a.imgspect.imgbits.length;c<f;c++){var g=a.urnCoords(c);b[c]='<w facs="'+g+'">'+a.imgspect.imgbits[c].caption+"</w>"}return b};a.urnCoords=function(b){b=a.imgspect.imgbits[b].citeCoords();return a.urn+"@"+b.join(",")};a.buildWarning=function(){$("#imgspectWarning").remove();$("body").append('\t\t\t\t<div id="imgspectWarning">\t\t\t\t\t<p>\t\t\t\t\t\tSwitching images will reset imgspect. \t\t\t\t\t</p>\t\t\t\t\t<p>\t\t\t\t\t\tYou will lose your highlights and captions \t\t\t\t\t\tif you have have not copied them to your main XML document.\t\t\t\t\t</p>\t\t\t\t\t<p>\t\t\t\t\t\tDo you want to CONTINUE?\t\t\t\t\t</p>\t\t\t\t\t<div id="imgspectButtons">\t\t\t\t\t\t<a id="imgspectWarningOk" href="">CONTINUE</a>\t\t\t\t\t\t<a id="imgspectWarningCancel" href="">CANCEL</a>\t\t\t\t\t</div>\t\t\t\t</div>');
a.warning=$("#imgspectWarning").plopup({button:"x"}).data("#imgspectWarning");$("#imgspectWarningOk").click(function(b){a.load(!0);b.preventDefault()});$("#imgspectWarningCancel").click(function(b){a.warning.hide();b.preventDefault()})};a.buildWait=function(){$("#imgspectWarning").remove();$("body").append('\t\t\t\t<div id="imgspectWarning">\t\t\t\t\t<p>\t\t\t\t\t\tLoading hi-res image.\t\t\t\t\t</p>\t\t\t\t\t<p>\t\t\t\t\t\tThis may take a while.\t\t\t\t\t</p>\t\t\t\t\t<div class="space"><img src="/javascripts/imgspect/src/img/ajax-loader.gif" /></div>\t\t\t\t</div>');
a.warning=$("#imgspectWarning").plopup({button:"x"}).data("#imgspectWarning");$(document).on("IMGSPECT-READY",function(){$("#imgspectWarning").remove()})};a.getUrn=function(){return a.imgspect.src.params().urn};a.getTags=function(a){var b=this;a=$.parseXML(a.smoosh());$(a).find("w").each(function(){var a=this.innerHTML,c=$(this).attr("facs").split("@"),e=c[0],c=c[1].split(",");e in b.w_tags||(b.w_tags[e]=[]);b.w_tags[e].push({caption:a,coords:c})})};a.clickListen=function(a){var b=this;$("#"+a).click(function(a){a.preventDefault();
a=$(this).attr("href");if(null==b.imgspect||b.imgspect.src!=a)b.img=new Image,b.img.onload=function(){b.load()},b.img.src=a})};a.loadTags=function(){if(void 0==this.w_tags||this.imgspect.src in this.w_tags){for(var a=this.imgspect.src,b=this.imgspect.orig_w,c=this.imgspect.orig_h,g=0,k=this.w_tags[a].length;g<k;g++){var l=this.w_tags[a][g].coords,h=Math.floor(l[0]*b),m=Math.floor(l[1]*c);this.imgspect.liteAdd(h,m,Math.floor(l[2]*b)+h,Math.floor(l[3]*c)+m);this.imgspect.imgbits[g].setCaption(this.w_tags[a][g].caption)}this.imgspect.resize()}};
return{imgspect:a.imgspect,w_tags:a.w_tags,buildLinks:function(b,c){for(var f=0,g=c.length;f<g;f++){var k='<a id="imgUrn_'+f+'"class="imgUrn" href="http://services.perseus.tufts.edu/sparqlimg/api?request=GetBinaryImage&urn='+c[f]+'&w=3000"><img src="http://services.perseus.tufts.edu/sparqlimg/api?request=GetBinaryImage&urn='+c[f]+'&w=100"/></a>';jQuery(b).append(k);a.clickListen(k.attr("id"))}},getTags:a.getTags,buildTags:a.buildTags,loadTags:a.loadTags,load:a.load,clickListen:a.clickListen,start:function(){$(document).on("IMGSPECT-LINK_LOADED",
function(b,c){a.clickListen(c)})}}}var c;return{init:function(){c||(c=b());return c}}}();
(function(b){function c(a,b,c){this.elem=a;this.id=c;this.init(a,b)}c.prototype.init=function(a,c){this.options=b.extend({style:"full",closable:!1},c);this.events={change:"IMGBIT-CHANGE",closed:"IMGBIT-CLOSED",frame:"IMGBIT-FRAME"};this.original=b(this.elem).myHtml();this.href=b(this.elem).attr("href");this.caption=b(this.elem).text();this.imgHeight=this.imgWidth=null;this.timeCreated=(new TimeStamp).withUtc(!0);var d=this.href.split("imgbit=");this.src=this.href;this.param={};1<d.length&&(this.src=
d[0].substring(0,d[0].length-1),this.param=this.getToJson(d[1]));void 0!=this.param.w&&(this.param.z=this.param.w/(this.param.x2-this.param.x1));void 0!=this.param.h&&(this.param.z=this.param.h/(this.param.y2-this.param.y1));void 0!=this.param.c&&(this.culuh=new Culuh(this.param.c));this.param.z=void 0==this.param.z?1:this.param.z;b(this.elem).hasClass("min")&&(this.options.style=null);b(this.elem).hasClass("edit")&&(this.options.style="edit");b(this.elem).hasClass("closable")&&(this.options.closable=
!0);this.build()};c.prototype.build=function(){var a=this,c=b(a.elem).attr("id");b(a.elem).after('<div class="imgbit">');a.elem=b(a.elem).next();b(a.elem).attr("id",c);var c=b(a.elem).prev(),d=c.html();c.remove();null!=a.options.style&&b(a.elem).addClass(a.options.style);b(a.elem).append('<div class="view">');b(a.elem).append('<div class="text">'+d+"</div>");b(".text",a.elem).hide();null!=a.options.style&&b(".text",a.elem).show();var f=new Image;f.onload=function(){b(this).addClass("star");a.imgWidth=
f.width;a.imgHeight=f.height;b(".view",a.elem).append(this);a.viewCrop();a.imgMove();b(a.elem).prepend('<div style="clear:both"></div>');null!=a.options.style&&"edit"!=a.options.style&&b(a.elem).prepend('<a class="source" href="'+a.src+'">source</a>');b(a.elem).css({width:b(".view",a.elem).width()});a.editStart();!0==a.options.closable&&a.closeBuild();void 0!=a.param.c&&(b(a.elem).css({"background-color":"#"+a.param.c}),b(".close",a.elem).css({"background-color":"#"+a.param.c}));b(a.elem).trigger(a.events.change)};
f.src=a.src};c.prototype.closeBuild=function(){var a=this;b(a.elem).prepend('<a href="" class="close">x</a>');b(".close",a.elem).click(function(c){b(a.elem).trigger(a.events.closed);b(a.elem).trigger(a.events.change);c.preventDefault()})};c.prototype.captionResize=function(){var a=b(".text",this.elem),c=!1;!1==a.is(":visible")&&(c=!0);a.show();var d=a.height();!0==c&&a.hide();a=parseInt(a.css("font-size").replace("px",""));d=d>a?d:a;b(".caption",this.elem).height(d)};c.prototype.editStart=function(){var a=
this;"edit"==a.options.style&&(a.editBuild(),a.captionResize(),b(".caption",a.elem).keypress(function(b){13==b.which&&a.editSwitch()}),b(".caption",a.elem).bind("input propertychange",function(){a.setCaption(b(".caption",a.elem).val())}))};c.prototype.remove=function(){b(this.elem).remove()};c.prototype.setCaption=function(a){this.caption=a;b(".text",this.elem).text(this.caption);this.captionResize();b(this.elem).trigger(this.events.change)};c.prototype.idUpdate=function(a){b(this.elem).attr("id",
a)};c.prototype.editBuild=function(){var a=this,c='<textarea class="caption">'+b(".text",a.elem).text()+"</textarea>";b(".text",a.elem).after(c);b(".caption",a.elem).css({width:b(".view",a.elem).width()});void 0!=a.culuh&&b(".caption",a.elem).css({"background-color":a.culuh.sat(0.35,!0).hex()});b(".caption",a.elem).hide();b(".text",a.elem).on("touchstart click",function(b){b.preventDefault();a.editSwitch()});b(document).on("touchstart click",function(c){b(c.target).html()!=b(".caption",a.elem).html()&&
b(c.target).html()!=b(".text",a.elem).html()&&a.editHide()})};c.prototype.editSwitch=function(){b(".caption",this.elem).is(":visible")?this.editHide():(c.prototype.editHide(),this.editShow())};c.prototype.editHide=function(){b(".caption",this.elem).hide();b(".text",this.elem).show()};c.prototype.editShow=function(){b(".text",this.elem).hide();b(".caption",this.elem).show();b(".caption",this.elem).cursorToEnd()};c.prototype.viewCrop=function(){b(".view",this.elem).css({width:(this.param.x2-this.param.x1)*
this.param.z,height:(this.param.y2-this.param.y1)*this.param.z});b(this.elem).css({width:(this.param.x2-this.param.x1)*this.param.z})};c.prototype.imgMove=function(){b("img.star",this.elem).css({width:this.imgWidth*this.param.z,height:this.imgHeight*this.param.z,left:-1*this.param.x1*this.param.z,top:-1*this.param.y1*this.param.z})};c.prototype.sequence=function(a,c,d){var f=this;d=void 0!=d?d:0;c=void 0==c?!1:c;if(a.length<=d)!0==c&&f.sequence(a,c,0);else{f.param.x1=a[d].coords[0];f.param.y1=a[d].coords[1];
f.param.x2=a[d].coords[2]+f.param.x1;f.param.y2=a[d].coords[3]+f.param.y1;f.param.z=a[d].coords[4];var g=void 0==a[d].wipe?1:a[d].wipe,k=void 0==a[d].stay?5:a[d].stay;b("img.star, .view",f.elem).css({transition:"all "+g+"s","-webkit-transition":"all "+g+"s"});b(f.elem).css({transition:"all "+g+"s","-webkit-transition":"all "+g+"s"});f.imgMove();f.viewCrop();b(".caption",f.elem).hide();var l=null;"caption"in a[d]&&(l=a[d].caption,"min"!=f.options.style||null!=f.options.style)&&(b(".caption",f.elem).show(),
f.setCaption(l));d++;setTimeout(function(){f.sequence(a,c,d)},1E3*(k+g));b(f.elem).trigger(f.events.frame,{caption:l})}};c.prototype.getToJson=function(a){if(""==a||void 0==a)return{};var b={};a=a.split("%");for(var c=0,f=a.length;c<f;c++){var g=a[c].split("=");2==g.length&&(b[g[0]]=decodeURIComponent(g[1].replace(/\+/g,"")))}return b};c.prototype.html=function(){var a=-1==this.src.indexOf("?")?"?":"&";return('<a class="imgbit" \t\t\t\t\t\thref="'+this.src+"\t\t\t\t\t\t"+a+"imgbit=\t\t\t\t\t\tx1="+
this.param.x1+"\t\t\t\t\t\t%y1="+this.param.y1+"\t\t\t\t\t\t%x2="+this.param.x2+"\t\t\t\t\t\t%y2="+this.param.y2+"\t\t\t\t\t\t%c="+this.param.c+"\t\t\t\t\t\t%z="+this.param.z+'">\t\t\t\t\t\t'+this.caption+"\t\t\t\t\t<a>").smoosh()};c.prototype.sequenceFormat=function(){var a=parseInt(this.param.x1),b=parseInt(this.param.y1),c=parseInt(this.param.x2)-parseInt(this.param.x1),f=parseInt(this.param.y2)-parseInt(this.param.y1);return{coords:[a,b,c,f,this.param.z],caption:this.caption}};c.prototype.citeCoords=
function(){var a=[];a[0]=this.param.x1/this.imgWidth;a[1]=this.param.y1/this.imgHeight;a[2]=(this.param.x2-this.param.x1)/this.imgWidth;a[3]=(this.param.y2-this.param.y1)/this.imgHeight;for(var b=0,c=a.length;b<c;b++)a[b]=a[b].toFixed(4);return a};c.prototype.toJsonLD=function(a){return{"@context":"http://www.w3.org/ns/oa-context-20130208.json","@type":"oa:Annotation",annotatedAt:this.timeCreated,annotatedBy:{"@type":"foaf:Person"},motivatedBy:"perseus:transcribing",label:"isQuotationOf"}};jQuery(document).ready(function(a){jQuery.fn.imgbit=
function(a){var b=jQuery(this).selector;return this.each(function(){jQuery.data(this,b,new c(this,a,b))})}})})(jQuery);
(function(b){function c(a,b,c){this.elem=a;this.id=c;this.init(a,b)}c.prototype.init=function(a,c){this.colors={YELLOW:"#FFFF00",MAGENTA:"#FF00FF",CYAN:"#00FFFF"};this.options=b.extend({zoom_unit:0.1,lite_color:new Culuh(this.colors.YELLOW),lite_opacity:0.4,secs:0.5,load:null,info:null},c);this.events={change:"IMGSPECT-CHANGE",undo:"IMGSPECT-UNDO",error:"IMGSPECT-ERROR",update:"IMGSPECT-UPDATE",ready:"IMGSPECT-READY"};this.lites=[];this.imgbits=[];this.zoom_n=1;this.zoom_shift=null;this.pan={x:0,
y:0};this.c_lite=null;this.orig_w=b(this.elem).width();this.orig_h=b(this.elem).height();this.nav_scale=1;this.dragDiff={top:0,left:0};this.src=null;this.build();this.resize();this.outputBuild();this.start();null!=this.options.load&&this.load(this.options.load);b(this.elem).trigger(this.events.ready)};c.prototype.toJsonLD=function(){for(var a=[],b=0,c=this.imgbits.length;b<c;b++)a[b]=this.imgbits[b].toJsonLD(this.options.info);return a};c.prototype.dump=function(){console.log(this)};c.prototype.build=
function(){b(this.elem).wrap('<div class="imgspect">');this.elem=b(this.elem).parent();b("img",this.elem).wrap('<div class="nav">');b(".nav",this.elem).prepend('<div class="drag">');b(".nav",this.elem).wrap('<div class="ui">');b(".ui",this.elem).wrap('<div class="center">');b(this.elem).prepend('<div class="view">');b(".view",this.elem).prepend('<div class="draw">');this.src=b(".nav img",this.elem).attr("src");b(".draw",this.elem).css({"background-image":"url('"+this.src+"')"});this.toolsBuild();
this.dropBuild();b(this.elem).append('<div style="clear:both">')};c.prototype.toolsBuild=function(){b(".ui",this.elem).append('<div class="tools">');b(".tools",this.elem).append('\t\t\t\t<a href="#" class="tool zoom in">+</a>\t\t\t\t<a href="#" class="tool zoom out">-</a>\t\t ');b(".tools",this.elem).append('<div class="colors">');for(var a in this.colors){var c=a.toLowerCase();b(".colors",this.elem).append('<a href="#" class="tool color '+c+'">&nbsp;<a>');b(".color."+c,this.elem).css({"background-color":this.colors[a]})}b(".tools",
this.elem).append('<a href="#" class="tool undo">&larr;</a>');b(".tools",this.elem).append('<div style="clear:both">')};c.prototype.dropBuild=function(){b(this.elem).before('\t\t\t<div id="drop">\t\t\t\t<div class="sortBits">\t\t\t\t\t<a href="" id="time" class="sort">Time</a>\t\t\t\t\t<a href="" id="space" class="sort">Space</a>\t\t\t\t</div>\t\t\t\t<div class="imgbits"></div>\t\t\t</div>'.smoosh());b("#drop .sortBits").hide();this.drop=b("#drop").menumucil({cover:!0,closed:"&#9660",open:"&#9650"}).data("#drop");
this.dropStart()};c.prototype.dropCount=function(){var a=this.lites.length;b("#drop .extra").text(a)};c.prototype.dropStart=function(){var a=this;b(a.elem).on(a.events.change,function(b){b=a.liteLast().id;a.imgbitAdd(b);a.dropCount()});b("#drop .sort").on("touchstart click",function(c){c.stopPropagatin();c.preventDefault();c=b(this).attr("id");a.imgbitsSort(c)})};c.prototype.imgbitAdd=function(a){var c=this.liteToImgbit(a);b("#drop .imgbits").append(c);c="#drop #imgbit-"+a;this.imgbits.push(b(c).imgbit().data(c));
this.imgbitStart(a)};c.prototype.imgbitsSort=function(a){a=void 0==a?"time":a;var b=new TimeStamp;switch(a){case "time":a=0;for(var c=this.imgbits.length;a<c;a++)b.toUnix(this.imgbits[a].timeCreated);break;case "space":(new Sorted).areaSort(this.imgbits,"param.x1","param.y1","param.y2")}};c.prototype.imgbitRemove=function(a,c){try{if(0>a||a>=this.imgbits.length)throw"out of range";}catch(d){b(this.elem).trigger(this.events.error,{error:d});return}this.imgbits[a].remove();this.imgbits.splice(a,1);
for(var f=0,g=this.imgbits.length;f<g;f++)this.imgbits[f].idUpdate("imgbit-"+f),this.imgbits[f].elem.off("IMGBIT-CHANGE"),this.imgbits[f].elem.off("IMGBIT-CLOSED"),this.imgbitStart(f);this.dropCount()};c.prototype.imgbitStart=function(a){var c=this;b("#drop #imgbit-"+a+" .view").on("touchstart click",function(a){a.stopPropagation();a.preventDefault();c.drop.close();a=b(this).parent().attr("id");var f=parseInt(a.replace("imgbit-",""));setTimeout(function(){c.liteShow(f)},500)});b("#drop #imgbit-"+
a).on("IMGBIT-CHANGE",function(){c.outputUpdate()});b("#drop #imgbit-"+a).on("IMGBIT-CLOSED",function(){c.liteRemove(a)})};c.prototype.outputBuild=function(){b(".tools",this.elem).append('<textarea readonly="readonly" id="imgspectOut" class="output"></textarea>');b(".output",this.elem).css({"max-height":b(".nav",this.elem).innerHeight()-b(".tool",this.elem).outerHeight()});this.outputInitText()};c.prototype.outputInitText=function(){b(".output",this.elem).val("WELCOME TO IMGSPECT \n------------------- \nImgspect is a tool for captioning or transcribing select areas of large images.\n\nUnique identifiers for your captioned areas will be written to this output window once you begin. \n\n\nHOW TO USE IMGSPECT \n------------------- \nDrag the see-through white rectangle over the area of the smaller image you want to inspect. \n\nClick and drag your mouse over the larger image to highlight areas you're interested in. \n\nClick the color squares to change the highlight color. \n\nClick the plus and minus buttons to zoom the larger image in and out. \n\nClick the back-arrow to remove the last highlight. \n\nClick the triangle to open a drop-down of just your highlighted areas. \n\nIn the drop-down view click the hash tag to caption or transcribe the highlighted area.\n\nIn the drop-down view click an img to find its original position in the larger image.\n\n".trim())};
c.prototype.outputUpdate=function(){b(".output",this.elem).val("");for(var a="",c=0,d=this.imgbits.length;c<d;c++)a+=this.imgbits[c].html()+"\n";b(".output",this.elem).val(a);b(this.elem).trigger(this.events.update)};c.prototype.outputSequence=function(){b(".output",this.elem).val("");for(var a=[],c=0,d=this.imgbits.length;c<d;c++)a[c]=this.imgbits[c].sequenceFormat();b(".output",this.elem).val(JSON.stringify(a))};c.prototype.resize=function(){this.navResize();this.viewResize();this.drawResize();
this.dragResize();this.liteResize()};c.prototype.dragNavDiff=function(){var a=b(".nav .drag",this.elem).offset().left,c=b(".nav",this.elem).offset().left,d=b(".nav .drag",this.elem).offset().top,f=b(".nav",this.elem).offset().top;this.dragDiff.left=a-c;this.dragDiff.top=d-f};c.prototype.start=function(){this.zoomStart();this.undoStart();this.liteStart();this.dragStart();this.sizeStart();this.colorStart()};c.prototype.colorStart=function(){var a=this;b(".color:first",a.elem).addClass("selected");b(".color",
a.elem).on("touchstart click",function(c){c.stopPropagation();c.preventDefault();b(".color",a.elem).removeClass("selected");b(this).addClass("selected");a.liteColor(b(this).css("background-color"))})};c.prototype.undoStart=function(){var a=this;b(".undo",a.elem).on("touchstart click",function(b){b.stopPropagation();b.preventDefault();a.liteRemove(a.lites.length-1)})};c.prototype.liteRemove=function(a){try{if(0>a||a>=this.imgbits.length)throw"out of range";}catch(c){b(this.elem).trigger(this.events.error,
{error:c});return}var d=this.lites.splice(a,1);this.imgbitRemove(a);this.liteRedraw();b(".nav .lite:eq("+a+")",this.elem).remove();b(this.elem).trigger(this.events.undo,{id:d.id});this.outputUpdate()};c.prototype.sizeStart=function(){var a=this,c;b(window).resize(function(){c&&clearTimeout(c);c=setTimeout(function(){a.resize()},10)})};c.prototype.drawMouseDown=function(a){this.c_lite=b(document.createElement("div")).addClass("lite");b(".draw",this.elem).append(this.c_lite);a=this.viewMousePos(a);
var c=b(".draw",this.elem).position();this.c_pos={left:a.left-c.left,top:a.top-c.top};this.c_lite.css({left:this.c_pos.left,top:this.c_pos.top,"background-color":"#"+this.options.lite_color.hex(),opacity:this.options.lite_opacity})};c.prototype.drawMouseMove=function(a){if(null!=this.c_lite){var c=this.c_pos;a=this.viewMousePos(a);var d=b(".draw",this.elem).position();a.left-=d.left;a.top-=d.top;c.left>a.left?this.c_lite.css({left:a.left,width:c.left-a.left}):this.c_lite.css({left:c.left,width:a.left-
c.left});c.top>a.top?this.c_lite.css({top:a.top,height:c.top-a.top}):this.c_lite.css({top:c.top,height:a.top-c.top})}};c.prototype.drawMouseUp=function(a){if(null!=this.c_lite)if(0==this.c_lite.width()||0==this.c_lite.height())this.c_lite=null;else{var b=this.c_lite.position();a=b.left/this.zoom_n;var b=b.top/this.zoom_n,c=a+this.c_lite.width()/this.zoom_n,f=b+this.c_lite.height()/this.zoom_n;this.liteAdd(a,b,c,f)}};c.prototype.liteStart=function(){var a=this;b(".view",a.elem).mousedown(function(b){b.preventDefault();
a.drawMouseDown(b)});b(".view",a.elem).bind("touchstart",function(b){b.preventDefault();a.drawMouseDown(b)});b(".view",a.elem).mousemove(function(b){b.preventDefault();a.drawMouseMove(b)});b(".view",a.elem).bind("touchmove",function(b){b.preventDefault();a.drawMouseMove(b)});b(a.elem).mouseup(function(b){b.preventDefault();a.drawMouseUp(b)});b(a.elem).bind("touchend",function(b){b.preventDefault();a.drawMouseUp(b)})};c.prototype.liteAdd=function(a,c,d,f){this.lites.push({x1:parseInt(a),y1:parseInt(c),
x2:parseInt(d),y2:parseInt(f),zoom:this.zoom_n,color:this.options.lite_color,opacity:this.options.lite_opacity,id:this.lites.length});this.navLiteDraw(this.liteLast().id);this.c_pos=this.c_lite=null;b(this.elem).trigger(this.events.change)};c.prototype.liteDom=function(){return b(document.createElement("div")).addClass("lite")};c.prototype.navLiteDraw=function(a){try{if(0>a||a>=this.lites.length)throw"out of range";}catch(c){b(this.elem).trigger(this.events.error,{error:c});return}var d=this.liteDom(),
f=b(".nav",this.elem);f.append(d);f=f.position();a=this.lites[a];d.css({left:a.x1/this.nav_scale+f.left,top:a.y1/this.nav_scale+f.top,width:a.x2/this.nav_scale-a.x1/this.nav_scale,height:a.y2/this.nav_scale-a.y1/this.nav_scale,"background-color":"#"+a.color.hex(),opacity:a.opacity})};c.prototype.liteLast=function(){return this.lites[this.lites.length-1]};c.prototype.liteResize=function(){this.liteRedraw()};c.prototype.liteShow=function(a){try{if(0>a||a>=this.lites.length)throw"out of range";}catch(c){b(this.elem).trigger(this.events.error,
{error:c});return}var d=this.lites[a];a=d.x1+(d.x2-d.x1)/2;d=d.y1+(d.y2-d.y1)/2;a-=b(".view",this.elem).width()/2/this.zoom_n;d-=b(".view",this.elem).height()/2/this.zoom_n;this.goTo(a,d)};c.prototype.liteRedraw=function(){b(".draw .lite",this.elem).remove();b(".draw",this.elem).position();for(var a=0,c=this.lites.length;a<c;a++){var d=this.liteDom();b(".draw").append(d);d.css({left:this.lites[a].x1*this.zoom_n,top:this.lites[a].y1*this.zoom_n,width:(this.lites[a].x2-this.lites[a].x1)*this.zoom_n,
height:(this.lites[a].y2-this.lites[a].y1)*this.zoom_n,"background-color":"#"+this.lites[a].color.hex(),opacity:this.lites[a].opacity})}};c.prototype.navLiteClear=function(){b(".nav .lite",this.elem).remove()};c.prototype.navLiteRedraw=function(){this.navLiteClear();for(var a=0,b=this.lites.length;a<b;a++)this.navLiteDraw(a)};c.prototype.liteColor=function(a){a=a.toUpperCase();this.options.lite_color=a in this.colors?new Culuh(this.colors[a]):new Culuh(a)};c.prototype.liteToImgbit=function(a){try{if(0>
a||a>=this.lites.length)throw"out of range";}catch(c){b(this.elem).trigger(this.events.error,{error:c});return}var d=this.lites[a],f=d.color,g=-1==this.src.indexOf("?")?"?":"&";return('<a id="imgbit-'+a+'" class="imgbit edit closable" href="'+this.src+"\t\t\t\t"+g+"imgbit=\t\t\t\tx1="+d.x1+"\t\t\t\t%y1="+d.y1+"\t\t\t\t%x2="+d.x2+"\t\t\t\t%y2="+d.y2+"\t\t\t\t%z="+d.zoom+"\t\t\t\t%c="+f.sat(0.5,!0).hex()+'\t\t\t\t">#</a>').smoosh()};c.prototype.zoomStart=function(){var a=this;b(".zoom",a.elem).on("touchstart click",
function(c){c.stopPropagation();c.preventDefault();b(this).hasClass("in")?a.zoomIn():a.zoomOut()})};c.prototype.zoomIn=function(){this.zoom("IN")};c.prototype.zoomOut=function(){this.zoom("OUT")};c.prototype.zoom=function(a){var c=this.zoom_n;switch(a.toUpperCase()){case "IN":this.zoom_n+=this.options.zoom_unit;break;case "OUT":this.zoom_n-=this.options.zoom_unit}a=b(".draw",this.elem).position().top;var d=b(".draw",this.elem).position().left;a=a/c-a/this.zoom_n;d=d/c-d/this.zoom_n;this.zoom_shift=
{top:a,left:d};this.resize()};c.prototype.dragStart=function(){var a=this;b(".drag",a.elem).draggable({containment:"parent",scroll:!1,drag:function(){a.drawResize()},stop:function(){a.dragNavDiff()}});var c=b(".nav",this.elem).offset();b(".drag",a.elem).css({left:c.left,top:c.top})};c.prototype.dragHandler=function(a,b){this.drawMove(-1*(b.left-a.left)*this.zoom_n*this.nav_scale,-1*(b.top-a.top)*this.zoom_n*this.nav_scale)};c.prototype.dragResize=function(){var a=b(".view",this.elem),c=b(".draw",
this.elem),d=a.width()/c.width(),d=1<d?1:d,a=a.height()/c.height(),a=1<a?1:a,c=b(".nav img",this.elem),d=c.width()*d,a=c.height()*a,c=b(".nav",this.elem).offset().left,f=b(".nav",this.elem).offset().top;b(".drag",this.elem).css({width:d,height:a,left:c+this.dragDiff.left,top:f+this.dragDiff.top});this.zoom_shift=null};c.prototype.drawMove=function(a,c){b(".draw",this.elem).css({left:a,top:c})};c.prototype.drawResize=function(){b(".draw",this.elem).css({width:this.orig_w*this.zoom_n,height:this.orig_h*
this.zoom_n});var a=b(".nav",this.elem).position(),c=b(".drag",this.elem).position();this.dragHandler(a,c)};c.prototype.navResize=function(){var a=b(".nav",this.elem).height();this.nav_scale=this.orig_h/a;b(".nav img",this.elem).css({height:a});this.navLiteRedraw()};c.prototype.viewResize=function(){var a=b(this.elem).width();b(".view",this.elem).css({width:a})};c.prototype.viewMousePos=function(a){var c=b(".view",this.elem).position(),d=void 0!=a.clientX?a.clientX:a.originalEvent.pageX;a=void 0!=
a.clientY?a.clientY+b(window).scrollTop():a.originalEvent.pageY;return{left:d-c.left,top:a-c.top}};c.prototype.goTo=function(a,c,d){var f=this;a=void 0==a?0:a;c=void 0==c?0:c;d=void 0==d?f.options.secs:d;var g=b(".nav",this.elem).position(),k=b(".nav",this.elem).width(),l=b(".nav",this.elem).height(),h=b(".drag",this.elem).width(),m=b(".drag",this.elem).height();a=a/f.nav_scale+g.left;c=c/f.nav_scale+g.top;a=a<g.left?g.left:a;c=c<g.top?g.top:c;k=g.left+k-h;l=g.top+l-m;a=a>k?k:a;c=c>l?l:c;b(".drag",
f.elem).animate({left:a,top:c},{duration:1E3*d,step:function(){var a=b(".drag",this.elem).position();f.dragHandler(g,a)}})};c.prototype.load=function(a){};c.prototype["export"]=function(){};jQuery(document).ready(function(a){jQuery.fn.imgspect=function(a){var b=jQuery(this).selector;return this.each(function(){jQuery.data(this,b,new c(this,a,b))})}})})(jQuery);

